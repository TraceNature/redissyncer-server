(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d4f56bf"],{"253e":function(e,t,a){"use strict";a("c457")},"333d":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},i=[];a("c5f6");Math.easeInOutQuad=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function s(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function o(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function d(e,t,a){var n=o(),i=e-n,d=20,l=0;t="undefined"===typeof t?500:t;var u=function e(){l+=d;var o=Math.easeInOutQuad(l,n,i,t);s(o),l<t?r(e):a&&"function"===typeof a&&a()};u()}var l={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&d(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&d(0,800)}}},u=l,c=(a("e498"),a("2877")),p=Object(c["a"])(u,n,i,!1,null,"6af373ef",null);t["a"]=p.exports},6724:function(e,t,a){"use strict";a("8d41");var n="@@wavesContext";function i(e,t){function a(a){var n=Object.assign({},t.value),i=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),r=i.ele;if(r){r.style.position="relative",r.style.overflow="hidden";var s=r.getBoundingClientRect(),o=r.querySelector(".waves-ripple");switch(o?o.className="waves-ripple":(o=document.createElement("span"),o.className="waves-ripple",o.style.height=o.style.width=Math.max(s.width,s.height)+"px",r.appendChild(o)),i.type){case"center":o.style.top=s.height/2-o.offsetHeight/2+"px",o.style.left=s.width/2-o.offsetWidth/2+"px";break;default:o.style.top=(a.pageY-s.top-o.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",o.style.left=(a.pageX-s.left-o.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return o.style.backgroundColor=i.color,o.className="waves-ripple z-active",!1}}return e[n]?e[n].removeHandle=a:e[n]={removeHandle:a},a}var r={bind:function(e,t){e.addEventListener("click",i(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[n].removeHandle,!1),e.addEventListener("click",i(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[n].removeHandle,!1),e[n]=null,delete e[n]}},s=function(e){e.directive("waves",r)};window.Vue&&(window.waves=r,Vue.use(s)),r.install=s;t["a"]=r},7456:function(e,t,a){},"8d41":function(e,t,a){},c457:function(e,t,a){},e498:function(e,t,a){"use strict";a("7456")},e5dd:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("\n      新建映射关系\n    ")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"映射ID",width:"210px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Redis版本",width:"210px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.redis_version))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"RDB版本",width:"255px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.rdb_version))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,i=t.$index;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleUpdate(n,i)}}},[e._v("\n          编辑\n        ")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n,i)}}},[e._v("\n          删除\n        ")])]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.currentPage,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"currentPage",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.getList}}),e._v(" "),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.addRdbData.dialogFormVisible},on:{"update:visible":function(t){return e.$set(e.addRdbData,"dialogFormVisible",t)}}},[a("div",[a("div",{staticStyle:{height:"300px"}},[a("el-form",{ref:"taskForm",attrs:{model:e.addRdbData.taskForm,rules:e.addRdbData.rdbrules,"label-position":e.labelPosition,"label-width":"100px"}},[a("el-form-item",{attrs:{prop:"redis_version",label:"Redis版本"}},[a("el-input",{attrs:{placeholder:"Redis版本"},model:{value:e.addRdbData.taskForm.redis_version,callback:function(t){e.$set(e.addRdbData.taskForm,"redis_version",t)},expression:"addRdbData.taskForm.redis_version"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"rdb_version",label:"RDB版本"}},[a("el-input",{attrs:{type:"number",placeholder:"RDB版本"},model:{value:e.addRdbData.taskForm.rdb_version,callback:function(t){e.$set(e.addRdbData.taskForm,"rdb_version",t)},expression:"addRdbData.taskForm.rdb_version"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.ResettaskForm}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.insertRdbData}},[e._v("提交")])],1)],1)])])],1)},i=[],r=(a("55dd"),a("96cf"),a("3b8d")),s=a("b775");function o(e){return Object(s["a"])({url:"/api/v2/getRdbListByPage",method:"post",json:!0,data:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}function d(e){return Object(s["a"])({url:"/api/v2/updateRdbVersion",method:"post",json:!0,data:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}function l(e){return Object(s["a"])({url:"/api/v2/insetRdbVersion",method:"post",json:!0,data:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}function u(e){return Object(s["a"])({url:"/api/v2/deleteRdbVersion",method:"post",json:!0,data:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}var c=a("6724"),p=a("ed08"),m=a("333d"),f=[{key:"CN",display_name:"China"},{key:"US",display_name:"USA"},{key:"JP",display_name:"Japan"},{key:"EU",display_name:"Eurozone"}],g=f.reduce((function(e,t){return e[t.key]=t.display_name,e}),{}),h={name:"RdbList",components:{Pagination:m["a"]},directives:{waves:c["a"]},filters:{deleteTaskButtion:function(e){var t={CREATING:"info",CREATED:"info",STOP:"danger",RDBRUNNING:"info",COMMANDRUNNING:"info",RUN:"info",BROKEN:"danger"};return t[e]},typeFilter:function(e){return g[e]}},data:function(){return{tableKey:0,list:null,total:0,listLoading:!0,labelPosition:"left",listQuery:{currentPage:1,pageSize:10},addRdbData:{dialogFormVisible:!1,taskForm:{id:0,redis_version:null,rdb_version:null},rdbrules:{redis_version:[{required:!0,message:"Redis版本不能为空",trigger:"blur"}],rdb_version:[{required:!0,message:"Rdb版本不能为空",trigger:"blur"}]}},showRdbTask:{dialogShowTaskFormVisible:!1,temp:{id:"",redis_version:null,rdb_version:null}},dialogStatus:"",textMap:{update:"编辑映射关系",create:"创建映射关系",showTaskData:"任务详情"}}},watch:{list:function(){this.timer()}},created:function(){this.getList()},mounted:function(){},destroyed:function(){clearTimeout(this.timer)},methods:{getList:function(){var e=this;this.listLoading=!0,o(this.listQuery).then((function(t){e.list=t.data.items,e.total=t.data.totalNum})),this.listLoading=!1},getListWithOutLoading:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o(this.listQuery).then((function(e){t.list=e.data.items,t.total=e.data.totalNum}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),timer:function(){var e=this;return setTimeout((function(){e.getListWithOutLoading()}),3e3)},deleteRDBTask:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,a){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,n={id:t.id,redis_version:t.redis_version,rdb_version:t.rdb_version},e.next=4,u(n);case 4:i=e.sent,"success"===i.msg?(this.list.splice(a,1),this.$message({message:"删除映射关系成功",type:"success"})):this.$message({message:"删除映射关系失败["+i.msg+"]",type:"error"}),this.listLoading=!1;case 7:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),insertRDBTask:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.next=3,l(t);case 3:a=e.sent,"request is successful"===a.msg?(this.addRdbData.dialogFormVisible=!1,this.addRdbData.taskForm.rdb_version=null,this.addRdbData.taskForm.redis_version=null,this.$message({message:"添加映射关系成功",type:"success"})):this.$message({message:"添加映射关系失败["+a.msg+"]",type:"error"}),this.listLoading=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),updateRDBTask:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.next=3,d(t);case 3:a=e.sent,"success"===a.msg?(this.addRdbData.dialogFormVisible=!1,this.addRdbData.taskForm.rdb_version=null,this.addRdbData.taskForm.redis_version=null,this.$message({message:"修改映射关系成功",type:"success"})):this.$message({message:"修改映射关系失败["+a.msg+"]",type:"error"}),this.listLoading=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),formatJson:function(e){return this.list.map((function(t){return e.map((function(e){return"timestamp"===e?Object(p["f"])(t[e]):t[e]}))}))},onSelectTasktype:function(e){this.$forceUpdate()},getSortClass:function(e){var t=this.listQuery.sort;return t==="+".concat(e)?"ascending":"descending"},ResettaskForm:function(){this.$refs["taskForm"].resetFields(),this.addRdbData.taskForm.rdb_version=null,this.addRdbData.taskForm.redis_version=null},handleCreate:function(){var e=this;this.dialogStatus="create",this.addRdbData.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["taskForm"].clearValidate()}))},insertRdbData:function(){var e=this;this.$refs["taskForm"].validate((function(t){if(t){if(null==e.addRdbData.taskForm.redis_version)return e.$message({message:"redis_version不能为空",type:"error"}),null;if(null==e.addRdbData.taskForm.rdb_version)return e.$message({message:"rdb_version",type:"error"}),null;"create"===e.dialogStatus?e.insertRDBTask(e.addRdbData.taskForm):"update"===e.dialogStatus&&e.updateRDBTask(e.addRdbData.taskForm),e.$nextTick((function(){e.$refs["taskForm"].clearValidate()}))}}))},handleDelete:function(e,t){var a=this;this.$confirm("此操作将删除该映射关系, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.deleteRDBTask(e,t)})).catch((function(){}))},handleUpdate:function(e,t){var a=this;this.dialogStatus="update",this.addRdbData.taskForm.id=e.id,this.addRdbData.taskForm.rdb_version=e.rdb_version,this.addRdbData.taskForm.redis_version=e.redis_version,this.addRdbData.dialogFormVisible=!0,this.$nextTick((function(){a.$refs["taskForm"].clearValidate()}))}}},v=h,b=(a("253e"),a("2877")),y=Object(b["a"])(v,n,i,!1,null,null,null);t["default"]=y.exports}}]);